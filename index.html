<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Custom Video Player - Auto Quality Toggle</title>
    <style>
        /* Basic styles for the video container */
        .video-container {
            max-width: 600px;
            top: 110px;
            bottom: 140px;
            right: 190px;
            left: -115px;
            margin: 10px auto;
            background: black;
            position: relative;
            border: 1px solid #ddd;
            transform-origin: center center;
            transform: rotate(90deg); /* Rotate container */
            height: 100vw;
            width: 100vh;
        }

        video {
            width: 120%;
            height: 90%;
        }

        /* Style for buttons container */
        .buttons-container {
            position: absolute;
            top: 357px;
            left: 195px;
           border: yes;
 display: flex;
            gap: 13px;
            transform: rotate(-360deg); /* Rotate buttons back to normal */
            transition: opacity 0.5s;
            opacity: 1; /* Initially visible */
        }

        /* Style for each button */
        .server-btn {
            background-color: Yellow;
            color: black;
            font-weight: bold;
border: none;
            padding: 5px 10px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
        }

        /* Highlight for selected server */
        .server-btn.active {
            background-color: #00FFFF;
        }

        /* Style for bottom controls */
        .controls {
            position: absolute;
            bottom: 10px;
            left: 10px;
          right: 100px

            color: red;
            transform: rotate(-360deg); /* Rotate controls back to normal */
        }

        /* Style for quality buttons */
        .quality-container {
            position: absolute;
            bottom: 50px;
         font-weight: bold;
   left: 15px;
            display: flex;
border-radius: 20px;
            flex-direction: column;
            gap: 10px;
            transform: rotate(-360deg); /* Rotate controls back to normal */
            display: none; /* Initially hidden */
        }

        .quality-btn {
            background-color: grey;
            color: black;
           font-weight: bold;
 border: none;
border-radius: 20px;
            padding: 5px 10px;
            margin: 5px;
            cursor: pointer;
        }

        .quality-btn.active {
            background-color: #00FFFF;
        }

        /* Style for the quality options toggle button */
        .toggle-quality-btn {
        position: absolute;
 font-weight: bold;
   background-color: red;
            color: white;
             top: 353px;
            left: 10px;
      border-radius: 20px;     
 border: yes;
            padding: 5px 10px;
            margin: 5px;
            cursor: pointer;
        }

        body {
            background-image: url('https://i.ibb.co/XVPL5Cb/images-3.png'); /* Fixed background */
            background-attachment: fixed;
            background-size: cover;
        }
    </style>
</head>
<body>

<div class="video-container">
    <video id="videoPlayer" controls></video>

    <!-- Server Buttons -->
    <div class="buttons-container">
        <button class="server-btn" id="server1Btn">Server 1</button>
        <button class="server-btn" id="server2Btn">Server 2</button>
        <button class="server-btn" id="server3Btn">Server 3</button>
    </div>

    <!-- Quality Buttons -->
    <div class="quality-container" id="qualityContainer">
        <button class="quality-btn active" id="autoQuality">Auto</button>
        <!-- Quality options will be dynamically created here -->
    </div>
    
    <!-- Toggle Quality Options Button -->
    <button class="toggle-quality-btn" id="toggleQualityOptions">Quality Options</button>
</div>

<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
<script>
    const video = document.getElementById('videoPlayer');
    const serverButtons = document.querySelectorAll('.server-btn');
    const qualityContainer = document.getElementById('qualityContainer');
    const toggleQualityButton = document.getElementById('toggleQualityOptions');
    let hls = null; // Declare the HLS instance

    // Server URLs
    const serverLinks = {
        server1: 'https://d75dqofg5kmfk.cloudfront.net/bpk-tv/9XM/default/index.m3u8',
        server2: 'https://tsports.iptvbd.xyz/master_480.m3u8',
        server3: 'https://proxiimity-fire.mominulislamm3u8.workers.dev/stream.m3u8?id=0000001'
    };

    // Switch server function
    function switchServer(url) {
        if (hls) {
            hls.destroy(); // Destroy the previous HLS instance before switching
        }

        hls = new Hls(); // Initialize a new HLS instance
        hls.loadSource(url); // Load the new source URL
        hls.attachMedia(video); // Attach HLS to the video element

        // Once media is attached, show available quality levels
        hls.on(Hls.Events.MANIFEST_PARSED, () => {
            const levels = hls.levels; // Get available quality levels

            // Clear the current quality buttons in the container
            qualityContainer.innerHTML = '<button class="quality-btn active" id="autoQuality">Auto</button>';

            // Create buttons for each quality level
            levels.forEach((level, index) => {
                const button = document.createElement('button');
                button.classList.add('quality-btn');
                button.textContent = `${level.height}p`; // Use height as quality label
                button.addEventListener('click', () => selectQuality(index));
                qualityContainer.appendChild(button);
            });

            // Auto quality button event
            document.getElementById('autoQuality').addEventListener('click', () => {
                hls.currentLevel = -1; // Auto mode
                setActiveQualityButton('autoQuality'); // Set active button to Auto
            });
        });
    }

    // Quality selection handling
    function selectQuality(levelIndex) {
        hls.currentLevel = levelIndex; // Set the selected quality level
        alert(`Switched to quality level ${hls.levels[levelIndex].height}p`); // Display selected quality
        setActiveQualityButton(`quality-btn-${levelIndex}`); // Set the selected button active
    }

    // Function to set the active quality button
    function setActiveQualityButton(activeId) {
        const qualityButtons = document.querySelectorAll('.quality-btn');
        qualityButtons.forEach(btn => {
            btn.classList.remove('active');
            if (btn.id === activeId) {
                btn.classList.add('active');
            }
        });
    }

    // Toggle quality options display
    toggleQualityButton.addEventListener('click', () => {
        if (qualityContainer.style.display === 'none' || qualityContainer.style.display === '') {
            qualityContainer.style.display = 'flex'; // Show quality options
            toggleQualityButton.textContent = 'Hide Quality Options'; // Change button text
        } else {
            qualityContainer.style.display = 'none'; // Hide quality options
            toggleQualityButton.textContent = 'Show Quality Options'; // Change button text
        }
    });

    // Switch server when button is clicked
    serverButtons.forEach(button => {
        button.addEventListener('click', () => {
            // Remove active class from all buttons
            serverButtons.forEach(btn => btn.classList.remove('active'));
            button.classList.add('active'); // Set clicked button as active

            // Switch server based on button
            if (button.id === 'server1Btn') {
                switchServer(serverLinks.server1);
            } else if (button.id === 'server2Btn') {
                switchServer(serverLinks.server2);
            } else if (button.id === 'server3Btn') {
                switchServer(serverLinks.server3);
            }
        });
    });

    // Load the default server on page load
    switchServer(serverLinks.server1);
</script>

</body>
</html>
